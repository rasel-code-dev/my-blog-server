"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const { parseToken } = require("../jwt");
const response = require("../response");
function isAuth(req, res, next) {
    let token = req.headers["token"];
    if (!token) {
        req.user_id = null;
        return response(res, 404, "please login first");
    }
    parseToken(token).then(u => {
        req.user_id = u.id;
        req.user_email = u.email;
        next();
    }).catch(err => {
        req.user_id = null;
        response(res, 404, "please login first");
    });
}
exports.default = isAuth;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaXNBdXRoLmpzIiwic291cmNlUm9vdCI6Ii4vc3JjLyIsInNvdXJjZXMiOlsic3JjL21pZGRsZXdhcmVzL2lzQXV0aC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU0sRUFBRSxVQUFVLEVBQUMsR0FBSSxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUE7QUFDeEMsTUFBTSxRQUFRLEdBQUksT0FBTyxDQUFDLGFBQWEsQ0FBQyxDQUFBO0FBRXhDLFNBQVMsTUFBTSxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsSUFBSTtJQUM1QixJQUFJLEtBQUssR0FBRyxHQUFHLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFBO0lBQ2hDLElBQUcsQ0FBQyxLQUFLLEVBQUM7UUFDUixHQUFHLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQTtRQUNsQixPQUFPLFFBQVEsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLG9CQUFvQixDQUFDLENBQUE7S0FDaEQ7SUFDRCxVQUFVLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQSxFQUFFO1FBQ3hCLEdBQUcsQ0FBQyxPQUFPLEdBQUcsQ0FBQyxDQUFDLEVBQUUsQ0FBQTtRQUNsQixHQUFHLENBQUMsVUFBVSxHQUFHLENBQUMsQ0FBQyxLQUFLLENBQUE7UUFDeEIsSUFBSSxFQUFFLENBQUE7SUFDUixDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFBLEVBQUU7UUFDWixHQUFHLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQTtRQUNsQixRQUFRLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxvQkFBb0IsQ0FBQyxDQUFBO0lBQzFDLENBQUMsQ0FBQyxDQUFBO0FBQ0osQ0FBQztBQUVELGtCQUFnQixNQUFNLENBQUEifQ==